{% for task in tasks %}
<li class="list-group-item px-3 py-3">
    <div class="d-flex align-items-center">
        <div class="form-check me-3">
            <input class="form-check-input" type="checkbox" id="task-check-{{ task.id }}"
                   {% if task.completed %}checked{% endif %}
                   hx-post="{% url 'complete_task' task.id %}"
                   hx-target="#task-list-wrapper">
        </div>
        <a class="text-dark text-decoration-none flex-grow-1"
           data-bs-toggle="collapse"
           href="#collapse-subtasks-{{ task.id }}"
           role="button"
           aria-expanded="false"
           aria-controls="collapse-subtasks-{{ task.id }}"
           hx-get="{% url 'get_subtasks' task.id %}"
           hx-trigger="click once"
           hx-target="#subtasks-container-{{ task.id }}">
            <span class="fw-bold">{{ task.title }}</span>
            {% if task.subtasks.count > 0 %}
            <span class="badge bg-secondary-subtle text-secondary-emphasis rounded-pill ms-2">
                {{ task.subtasks.count }}
            </span>
            {% endif %}
        </a>
        <button class="btn btn-outline-danger btn-sm border-0"
                hx-post="{% url 'delete_task' task.id %}"
                hx-target="#task-list-wrapper"
                hx-confirm="Bạn có chắc muốn xóa công việc này?">
            <i class="bi bi-trash3"></i>
        </button>
    </div>
    <div class="collapse" id="collapse-subtasks-{{ task.id }}">
        <div class="ps-5 pt-2" id="subtasks-container-{{ task.id }}"></div>
    </div>
</li>
{% empty %}
<li class="list-group-item text-center text-muted">Chưa có công việc nào.</li>
{% endfor %}